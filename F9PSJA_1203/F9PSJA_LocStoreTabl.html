<!DOCTYPE html>
<html lang="hu">
<head>
<meta charset="UTF-8">
<title>F9PSJA Órarend - Táblázat</title>
<style>
    body { font-family: Arial; background:#f5f5f5; padding:20px; }
    .container { background:#fff; padding:20px; border-radius:8px; max-width:950px; margin:auto; }
    table { width:100%; border-collapse: collapse; margin-top:15px; }
    th, td { border:1px solid #ccc; padding:8px; }
    th { background:#eee; }
    input, button { padding:6px; margin:5px; }
</style>
</head>
<body>

<div class="container">
<h2>F9PSJA Órarend</h2>

<input type="file" id="fileInput" onchange="loadJson()">
<button onclick="loadFromLocal()">LocalStorage betöltése</button>


<br>
<label>Keresés tárgy szerint:</label>
<input id="searchInput" placeholder="WebXML..." onkeyup="renderTable()">

<table>
<thead>
<tr>
    <th>Tárgy</th>
    <th>Nap</th>
    <th>Tól</th>
    <th>Ig</th>
    <th>Helyszín</th>
    <th>Oktató</th>
    <th>Szak</th>
    <th>Típus</th>
</tr>
</thead>
<tbody id="tableBody"></tbody>
</table>

</div>

<script>
const STORAGE_KEY = "orarendData";

function loadJson() {
    const file = document.getElementById("fileInput").files[0];
    if (!file) { alert("Válassz JSON fájlt!"); return; }

    const reader = new FileReader();
    reader.onload = () => {
        try {
            const json = JSON.parse(reader.result);
            const lessons = json.F9PSJA_orarend.ora;
            localStorage.setItem(STORAGE_KEY, JSON.stringify(lessons));
            renderTable();
        } catch (error) {
            alert("Hibás JSON!");
        }
    };

    reader.readAsText(file);
}

function renderTable() {
    const tbody = document.getElementById("tableBody");
    const data = JSON.parse(localStorage.getItem(STORAGE_KEY) || "[]");
    const search = document.getElementById("searchInput").value.toLowerCase();

    tbody.innerHTML = "";

    const filtered = data.filter(item =>
        item.targy.toLowerCase().includes(search)
    );

    filtered.forEach(item => {
        const row = document.createElement("tr");
        row.innerHTML = `
            <td>${item.targy}</td>
            <td>${item.idopont.nap}</td>
            <td>${item.idopont.tol}</td>
            <td>${item.idopont.ig}</td>
            <td>${item.helyszin}</td>
            <td>${item.oktato}</td>
            <td>${item.szak}</td>
            <td>${item._tipus}</td>
        `;
        tbody.appendChild(row);
    });
}
</script>

</body>
</html>
