<!DOCTYPE html>
<html lang="hu">
<head>
<meta charset="UTF-8">
<title>F9PSJA Órarend - Lista</title>
<style>
    body { font-family: Arial; background:#f5f5f5; padding:20px; }
    .container { background:#fff; padding:20px; border-radius:8px; max-width:900px; margin:auto; }
    .box { border:2px solid #ddd; padding:15px; border-radius:6px; margin-top:15px; background:white; }
    .lesson-title { font-weight:bold; font-size:20px; margin-bottom:10px; }
    label { font-weight:bold; }
    input, button { padding:6px; margin:5px; }
</style>
</head>
<body>

<div class="container">
<h2>F9PSJA Órarend</h2>

<input type="file" id="fileInput" onchange="loadJson()">
<button onclick="loadFromLocal()">LocalStorage betöltése</button>


<br><br>
<label>Keresés tárgy szerint:</label>
<input id="searchInput" placeholder="WebXML..." onkeyup="renderLessons()">

<div id="lessonList"></div>
</div>

<script>
const STORAGE_KEY = "orarendData";

function loadJson() {
    const file = document.getElementById("fileInput").files[0];
    if (!file) { alert("Válassz JSON fájlt!"); return; }

    const reader = new FileReader();
    reader.onload = () => {
        try {
            const json = JSON.parse(reader.result);

            const lessons = json.F9PSJA_orarend.ora;
            localStorage.setItem(STORAGE_KEY, JSON.stringify(lessons));

            renderLessons();
        } catch (error) {
            alert("Hibás JSON formátum!");
        }
    };

    reader.readAsText(file);
}

function loadFromLocal() {
    renderLessons();
}

function renderLessons() {
    const listDiv = document.getElementById("lessonList");
    const data = JSON.parse(localStorage.getItem(STORAGE_KEY) || "[]");
    const search = document.getElementById("searchInput").value.toLowerCase();

    listDiv.innerHTML = "";

    const filtered = data.filter(item =>
        item.targy.toLowerCase().includes(search)
    );

    filtered.forEach(item => {
        const box = document.createElement("div");
        box.className = "box";

        box.innerHTML = `
            <div class="lesson-title">${item.targy}</div>
            <div><b>Nap:</b> ${item.idopont.nap}</div>
            <div><b>Idő:</b> ${item.idopont.tol} - ${item.idopont.ig}</div>
            <div><b>Helyszín:</b> ${item.helyszin}</div>
            <div><b>Oktató:</b> ${item.oktato}</div>
            <div><b>Szak:</b> ${item.szak}</div>
        `;

        listDiv.appendChild(box);
    });
}
</script>

</body>
</html>
